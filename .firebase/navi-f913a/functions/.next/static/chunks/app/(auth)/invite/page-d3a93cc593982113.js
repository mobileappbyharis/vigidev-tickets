(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71],{7901:function(e,t,s){Promise.resolve().then(s.bind(s,9905))},9905:function(e,t,s){"use strict";s.d(t,{default:function(){return o}});var r=s(7437),i=s(2265),n=s(9376),l=s(2141),a=s(5898);function o(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{success:s,error:o}=(0,a.p)(),[c,u]=(0,i.useState)(""),[d,m]=(0,i.useState)(""),[x,f]=(0,i.useState)(!1),[b,h]=(0,i.useState)(!0),[p,g]=(0,i.useState)(""),[v,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!t.get("token")){o("Lien d'invitation invalide ou expir\xe9"),h(!1);return}j(!0),h(!1)},[t,o]);let N=async t=>{t.preventDefault(),f(!0);try{let{data:t,error:r}=await l.OQ.auth.signUp({email:p||"",password:c});if(r){o(r.message),f(!1);return}if(t.user){let{error:r}=await l.OQ.from("vigitckets_profiles").insert([{id:t.user.id,email:p||t.user.email,full_name:d,role:"technician"}]);if(r){o("Failed to create profile"),f(!1);return}s("Account created successfully! Redirecting..."),setTimeout(()=>{e.push("/vigidev/tickets")},2e3)}}catch(e){o("An unexpected error occurred"),console.error(e)}finally{f(!1)}};return b?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Validation de l'invitation..."})]})}):v?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 px-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center text-slate-900 mb-2",children:"VigiTickets"}),(0,r.jsx)("p",{className:"text-center text-slate-600 mb-8",children:"Rejoindre l'\xe9quipe Vigidev"}),(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),(0,r.jsx)("input",{type:"email",value:p,onChange:e=>g(e.target.value),required:!0,placeholder:"jean@example.com",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nom complet"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),required:!0,placeholder:"Jean Dupont",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Mot de passe"}),(0,r.jsx)("input",{type:"password",value:c,onChange:e=>u(e.target.value),required:!0,placeholder:"••••••••",minLength:6,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x}),(0,r.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Min. 6 caract\xe8res"})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600 bg-slate-50 p-3 rounded",children:"✓ Votre email est confirm\xe9 par le lien d'invitation"}),(0,r.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white font-medium py-2 rounded-lg hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors",children:x?"Cr\xe9ation du compte...":"Cr\xe9er mon compte"})]}),(0,r.jsx)("p",{className:"text-center text-slate-500 text-xs mt-6",children:"\xa9 2025 Vigidev. Tous droits r\xe9serv\xe9s."})]})})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Invitation invalide"}),(0,r.jsx)("p",{className:"text-slate-600 mb-6",children:"Le lien d'invitation a expir\xe9 ou est invalide. Veuillez contacter votre administrateur."}),(0,r.jsx)("a",{href:"/login",className:"inline-block bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors",children:"Retour \xe0 la connexion"})]})})}},5898:function(e,t,s){"use strict";s.d(t,{p:function(){return i}});var r=s(9064);function i(){return{success:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;r.ZP.success(e,{duration:t})},error:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;r.ZP.error(e,{duration:t})},info:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;(0,r.ZP)(e,{duration:t})},loading:e=>r.ZP.loading(e),dismiss:e=>{e?r.ZP.dismiss(e):r.ZP.dismiss()}}}},2141:function(e,t,s){"use strict";s.d(t,{OQ:function(){return l}});var r=s(3053);let i="https://tzmilnltvvtsvdmrkhin.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6bWlsbmx0dnZ0c3ZkbXJraGluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwMjI3NjMsImV4cCI6MjA2ODU5ODc2M30.Z0H2mZBMo6qRYrcgxCHNN5C6hLVR804_W28gK2mMz4o";if(!i||!n)throw Error("Missing Supabase environment variables. Check .env.local file.");let l=(0,r.eI)(i,n)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[53,64,971,117,744],function(){return e(e.s=7901)}),_N_E=e.O()}]);