(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6164:function(e,t,n){Promise.resolve().then(n.bind(n,6755))},6755:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(7437),s=n(2265),i=n(9376),u=n(2141);function l(){let e=(0,i.useRouter)(),{isLoading:t,isAuthenticated:n,isClient:l,isVigidev:a}=function(){let[e,t]=(0,s.useState)(null),[n,r]=(0,s.useState)(null),[i,l]=(0,s.useState)(!0),[a,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await u.OQ.auth.getUser();if(t(e),e){let{data:t,error:n}=await u.OQ.from("profiles").select("*").eq("id",e.id).single();if(n)throw n;r(t)}}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{l(!1)}})();let{data:{subscription:e}}=u.OQ.auth.onAuthStateChange(async(e,n)=>{var s;console.debug("[useAuth] Auth state changed:",e);let i=null!==(s=null==n?void 0:n.user)&&void 0!==s?s:null;if(t(i),i){let{data:e}=await u.OQ.from("profiles").select("*").eq("id",i.id).single();r(e)}else r(null);l(!1)});return()=>{null==e||e.unsubscribe()}},[]);let o=(null==n?void 0:n.role)==="client",d=(null==n?void 0:n.role)==="technician"||(null==n?void 0:n.role)==="developer"||(null==n?void 0:n.role)==="admin",f=(null==n?void 0:n.role)==="admin";return{user:e,profile:n,isLoading:i,error:a,isAuthenticated:!!e&&!!n,isClient:o,isVigidev:d,isAdmin:f}}();return(0,s.useEffect)(()=>{if(!t){if(!n){e.push("/login");return}l?e.push("/client/projects"):a?e.push("/vigidev/tickets"):e.push("/login")}},[t,n,l,a,e]),(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Chargement..."})]})})}},2141:function(e,t,n){"use strict";n.d(t,{OQ:function(){return u}});var r=n(3053);let s="https://tzmilnltvvtsvdmrkhin.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6bWlsbmx0dnZ0c3ZkbXJraGluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwMjI3NjMsImV4cCI6MjA2ODU5ODc2M30.Z0H2mZBMo6qRYrcgxCHNN5C6hLVR804_W28gK2mMz4o";if(!s||!i)throw Error("Missing Supabase environment variables. Check .env.local file.");let u=(0,r.eI)(s,i)},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[53,971,117,744],function(){return e(e.s=6164)}),_N_E=e.O()}]);